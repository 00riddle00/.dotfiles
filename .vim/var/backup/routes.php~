<?php

/*
|--------------------------------------------------------------------------
| Backend routes
|--------------------------------------------------------------------------
*/

/* Auth routes */
Route::get('osos/login', ['as' => 'getBackendLogin', 'uses' => 'Backend\AuthController@getLogin']);
Route::post('osos/login', ['as' => 'postBackendLogin', 'uses' => 'Backend\AuthController@postLogin']);
Route::get('osos/logout', ['as' => 'getBackendLogout', 'uses' => 'Backend\AuthController@getLogout']);

Route::group(['prefix' => 'osos', 'namespace' => 'Backend', 'middleware' => ['authAdmin', 'localeBackend']], function () {
    /* Dashboard */
    Route::get('/', ['uses' => 'DashboardController@getIndex']);
    Route::get('/dashboard', ['as' => 'dashboard', 'uses' => 'DashboardController@getDashboard']);

    /* Users module */
    Route::post('users/changeStatus', ['uses' => 'UserController@postChangeStatus']);
    Route::resource('users', 'UserController');

    /* Slider module */
    Route::get('slider/resort', ['as' => 'slider.resort', 'uses' => 'SliderController@getResort']);
    Route::resource('slider', 'SliderController');

    Route::post('/slider/images', [
        'as' => 'osos.uploads.images',
        'uses' => 'SliderController@uploadImages'
    ]);

    Route::post('slider/changeStatus', ['uses' => 'SliderController@postChangeStatus']);
    Route::post('slider/setSort', ['uses' => 'SliderController@postSetSort']);

    /* About module */
    Route::group(['prefix' => 'about-us'], function(){
        Route::get('/', [
            'as' => 'osos.about_us.index',
            'uses' => 'AboutUsController@getIndex'
        ]);

        Route::get('/create', [
            'as' => 'osos.about_us.create',
            'uses' => 'AboutUsController@getCreate'
        ]);

        Route::post('/create', [
            'as' => 'osos.about_us.create',
            'uses' => 'AboutUsController@postCreate'
        ]);

        Route::post('/images', [
            'as' => 'osos.about-us.images',
            'uses' => 'AboutUsController@uploadImages'
        ]);

        Route::post('/changeStatus', ['uses' => 'AboutUsController@postChangeStatus']);

        Route::get('/{id}', [
            'as' => 'osos.about_us.edit',
            'uses' => 'AboutUsController@getEdit'
        ]);

        Route::post('/{id}', [
            'as' => 'osos.about_us.edit',
            'uses' => 'AboutUsController@postEdit'
        ]);
    });

    /* products module */
    Route::group(['prefix' => 'products'], function(){
        Route::get('/', [
            'as' => 'osos.products.index',
            'uses' => 'ProductController@getIndex'
        ]);

        Route::get('/create', [
            'as' => 'osos.products.create',
            'uses' => 'ProductController@getCreate'
        ]);

        Route::post('/create', [
            'as' => 'osos.products.create',
            'uses' => 'ProductController@postCreate'
        ]);

        Route::post('/images', [
            'as' => 'osos.products.images',
            'uses' => 'ProductController@uploadImages'
        ]);

        Route::post('/changeStatus', ['uses' => 'ProductController@postChangeStatus']);

        Route::get('/resort', ['as' => 'osos.products.resort', 'uses' => 'ProductController@getResort']);

        Route::post('/setSort', ['uses' => 'ProductController@postSetSort']);

        Route::delete('/delete/{id}', ['uses' => 'ProductController@destroy']);

        Route::get('/{id}', [
            'as' => 'osos.products.edit',
            'uses' => 'ProductController@getEdit'
        ]);

        Route::post('/{id}', [
            'as' => 'osos.products.edit',
            'uses' => 'ProductController@postEdit'
        ]);
    });

    /* Services module */
    Route::group(['prefix' => 'services'], function(){
        Route::get('/', [
            'as' => 'osos.services.index',
            'uses' => 'ServiceController@getIndex'
        ]);

        Route::get('/create', [
            'as' => 'osos.services.create',
            'uses' => 'ServiceController@getCreate'
        ]);

        Route::post('/create', [
            'as' => 'osos.services.create',
            'uses' => 'ServiceController@postCreate'
        ]);

        Route::post('/images', [
            'as' => 'osos.services.images',
            'uses' => 'ServiceController@uploadImages'
        ]);

        Route::post('/changeStatus', ['uses' => 'ServiceController@postChangeStatus']);

        Route::get('/resort', ['as' => 'osos.services.resort', 'uses' => 'ServiceController@getResort']);

        Route::post('/setSort', ['uses' => 'ServiceController@postSetSort']);

        Route::delete('/delete/{id}', ['uses' => 'ServiceController@destroy']);

        Route::get('/{id}', [
            'as' => 'osos.services.edit',
            'uses' => 'ServiceController@getEdit'
        ]);

        Route::post('/{id}', [
            'as' => 'osos.services.edit',
            'uses' => 'ServiceController@postEdit'
        ]);
    });

    /* Contacts module */
    Route::group(['prefix' => 'contacts'], function(){
        Route::get('/', [
            'as' => 'osos.contacts.index',
            'uses' => 'ContactController@getIndex'
        ]);

        Route::get('/create', [
            'as' => 'osos.contacts.create',
            'uses' => 'ContactController@getCreate'
        ]);

        Route::post('/create', [
            'as' => 'osos.contacts.create',
            'uses' => 'ContactController@postCreate'
        ]);

        Route::post('/images', [
            'as' => 'osos.contacts.images',
            'uses' => 'ContactController@uploadImages'
        ]);

        Route::post('/changeStatus', ['uses' => 'ContactController@postChangeStatus']);

        Route::get('/resort', ['as' => 'osos.contacts.resort', 'uses' => 'ContactController@getResort']);

        Route::post('/setSort', ['uses' => 'ContactController@postSetSort']);

        Route::delete('/delete/{id}', ['uses' => 'ContactController@destroy']);

        Route::get('/{id}', [
            'as' => 'osos.contacts.edit',
            'uses' => 'ContactController@getEdit'
        ]);

        Route::post('/{id}', [
            'as' => 'osos.contacts.edit',
            'uses' => 'ContactController@postEdit'
        ]);
    });

    /* Google maps module */
    Route::get('maps/resort', ['as' => 'maps.resort', 'uses' => 'MapController@getResort']);
    Route::post('maps/changeStatus', ['uses' => 'MapController@postChangeStatus']);
    Route::post('maps/setSort', ['uses' => 'MapController@postSetSort']);
    Route::resource('maps', 'MapController');

    /* Languages module */
    Route::get('languages/resort', ['as' => 'languages.resort', 'uses' => 'LanguageController@getResort']);
    Route::post('languages/changeStatus', ['uses' => 'LanguageController@postChangeStatus']);
    Route::post('languages/setSort', ['uses' => 'LanguageController@postSetSort']);
    Route::resource('languages', 'LanguageController');

    // Timeline
    Route::group(['prefix' => 'timeline'], function() {
        Route::get('/', [
            'as' => 'osos.timeline.index',
            'uses' => 'TimeLineController@getIndex'
        ]);

        Route::post('/load', [
            'as' => 'osos.timeline.load',
            'uses' => 'TimeLineController@postLoad'
        ]);

        Route::get('/{id}', [
            'as' => 'osos.timeline.index.user_id',
            'uses' => 'TimeLineController@getIndexDetail'
        ]);

        Route::post('/restore/{id}', [
            'as' => 'osos.timeline.restore.id',
            'uses' => 'TimeLineController@restoreItem'
        ]);

    });

    // Uploads
    Route::group(['prefix' => 'uploads'], function(){

        // Images uploads
        Route::group(['prefix' => 'images'], function(){
            Route::post('/sort/{id}', [
                'as' => 'osos.uploads.images.sort.id',
                'uses' => 'ImagesUploadController@postSortImage'
            ]);

            Route::post('/link/{id}', [
                'as' => 'osos.uploads.images.link.id',
                'uses' => 'ImagesUploadController@postLinkImage'
            ]);

            Route::post('target/{id}', [
                'as' => 'osos.uploads.images.target.id',
                'uses' => 'ImagesUploadController@postTargetImage'
            ]);

            Route::post('/delete/{id}', [
                'as' => 'osos.uploads.images.delete.id',
                'uses' => 'ImagesUploadController@postDeleteImage'
            ]);
        });
    });
});

/*
|--------------------------------------------------------------------------
| Frontend routes
|--------------------------------------------------------------------------
*/
Route::group(['namespace' => 'Frontend', 'middleware' => 'localeFrontend'], function () {

    /*    $languages = \OsosTVS\Models\Language::where('is_active', '=', 1)->where('is_deleted', '=', 0)->get(); */

    if(isset($languages)) {
        foreach ($languages as $language) {
            \App::setLocale($language->code);

            Route::get('/', [
                'as'   => 'home',
                'uses' => 'PageController@getHome'
            ]);
        }
    }

    Route::group(['prefix' => 'languages-manage'], function() {
        Route::post('/change/{code}', [
            'as' => 'languages-manage.change.code',
            'uses' => 'ManageController@changeLanguage'
        ]);
    });
});
